---
title: "July 14th, 2025"
created: 2025-07-14 07:08:43
updated: 2025-07-20 20:37:21
---
  * 오늘 할 일
    * 로그 분석 -> pymupdf에서 이미지 읽는 방식  확인
      * 이미지를 읽어서 글을 추출한 것이 아니고 그냥 원천 데이터에 있는 그림과 글이 함께 있어서 그 글만 같이 pdf로 넣은 것으로 보임.
    * 프로그램 분석 및 수정. DB 저장 로직 위치 선정
    * 이번 주 목표는 pdf를 md로 변환한 것을 분석해서
      * 그림 파일로 따로 추출되는 표를 제외한 pdf 문서에 있는 표를 pymupdf4llm이 제대로 변환하지 못한 사례 분석해서 전처리로 교정할 수 있는 방법 탐색.
      * pdf 문서 내에 따로 그림으로 추출되는 표를 변환하는 방법 탐색.
  * 명경지수 -> 명징한 생각
  * 오늘 일 중 꼭 기억할 것은?
  * 내가 한 일 중 중요하고도 잘 했던 일은?
  * 05:00 밤에 많이 뒤척거린 바람에 충분히 자지 못해 일어나기가 힘들어서 달리기하지 않았다.
  * 07:08 cig 1
  * 08:29 cig 2
  * 08:46 프로그램 소스 지난 주 것과 주말에 한 것 비교 시작
    * 일단 주말에 만든 것은 에러 없이 잘 실행됨.
    * 데이터 분석한 것(process_pdf) 중간 결과는 json으로 저장됨.
    * 문자 추출 내용 비교도 json으로 저장됨.
  * 09:20 로그 분석 시작
    * extraction comparison
      * pymupdf는 그림이 있다고 표시하지 않았는데도 그림에 있는 문장을 추출했는데...
      * pymupdf4llm 통계에는 page수가 나타나지 않는다. -> 버그인 듯.
      * pymupdf에서 얻은 doc의 total_image 세는 곳에 버그가 있다. -> page.get_images()를 미리 실행해서 image_count 세도록 수정
  * 09:58 로그 분석
    * pymupdf open을 통해서 얻은 객체(page)에 get_images()를 호출하면 그림을 못 찾는데도 어떻게 그림에 있는 글을 추출했을까? -> pdf 이전에 html이 있었고 이를 pdf로 변환한 것이다. 따라서 html에 그림과 함께 글이 있었을 가능성이 크다.
    * page.info 수정
  * 10:26 로그 분석
    * pymupdf4llm으로 추출할 때 페이지 단위로 추출한 것은 dict 형식이다. 여기에 각 페이지 구조가 다 있다!
    * pymupdf4llm은 그림을 추출하니까 이걸 pymupdf처럼 OCR 처리해서 글로 바꾸는 함수를 추가. -> 김희민 매니저가 수정한 프로그램이 제대로 읽은다면 이 일은 필요없을 듯.
    * pymupdf4llm이 표를 다 인식해서 글로 바꾼다. 이에 비해 pymupdf는 그림 속 글은 추출하지만(그것도 완전하지 않다.) 표를 읽지 못한다. 따라서 pymupdf4llm이 pymupdf보다 추출한 글이 더 많다.
    * load_pdf에 그림이 있다면 그림이 있는 곳에 표시를 하고 추출한 그림파일을 찾아 읽은 후, processed_data에 표시한 곳에 추가해서 process_pdf에 넣는다? -> 이것도 마찬가지로 김희민 매니저가 수정한 프로그램이 제대로 읽은다면 이 일은 필요없을 듯.
  * 10:58 cig 3
  * 11:10 pymupdf가 그림을 찾지 못하는데도 글을 추출할 수 있었던 이유 찾기
    * pymupdf는 Tesseract-OCR를 이용. 따로 설치해야 한다. -> 그 패키지를 설치하지 않았는데도 그림에 있는 글이 추출될 수 있었던 것은? -> 이미 pdf 문서에 그 글이 다 들어가있었다?
    * 그림(jpg, png 등)은 반드시 pixmap으로 변환되어야 한다.
  * 11:49 권대영 부장이 fastapi와 vector DB 연동 가능하게 함.
  * 11:53 pdf 파일에 들어가는 그림에 집중? 그런데 표를 그린 그림은 과연 OCR을 통해서 markdown 표로 만들 수 있을까?
    * aws textract api가 있다는데. -> 수요일 회의에서 이 얘기했더니 서창수 매니저가 이미 해본 듯. 영어만 된다고 한다. 
  * 12:40 pdf에 html도 있는데 혹시 거기에 테이블 원형이 그대로 있지 않을까? -> 없다!!
  * 13:03 cig 4
  * 14:58 cig 5
  * 15:19 pymupdf4llm에서 누락된 것은 pymupdf의 텍스트와 비교해서 넣는 방법? 이것도 마찬가지로 김희민 매니저가 수정한 프로그램이 제대로 읽은다면 이 일은 필요없을 듯.
  * 16:46 cig 6
  * 17:05 모니터 반입
  * 17:55 실마리를 찾은 것 같다. 병합셀을 보면 None으로 되어 있다. 그렇다면 None을 채우면 된다.
  * 19:17 cig 7
  * 21:12 cig 9